# ClearBag éæ©Ÿèƒ½åˆ†æãƒ¬ãƒãƒ¼ãƒˆ

**ä½œæˆæ—¥**: 2026-02-23
**å¯¾è±¡ãƒ–ãƒ©ãƒ³ãƒ**: docs/update-readme-clearbag
**åˆ†æè¦³ç‚¹**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»å¯è¦³æ¸¬æ€§ãƒ»CI/CDãƒ»ãƒ†ã‚¹ãƒˆãƒ»ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»é–‹ç™ºè€…ä½“é¨“

---

## ç·åˆã‚¹ã‚³ã‚¢: 68 / 100

```
ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  7.0 / 10
å¯è¦³æ¸¬æ€§ãƒ»ç›£è¦–        â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  4.5 / 10  âš ï¸ æœ€ä½
CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  7.0 / 10
ãƒ†ã‚¹ãƒˆå“è³ª            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  6.5 / 10
ã‚³ãƒ¼ãƒ‰å“è³ªãƒ»ä¿å®ˆæ€§    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  7.0 / 10
ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  7.0 / 10
ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  6.5 / 10
é–‹ç™ºè€…ä½“é¨“            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  6.0 / 10
ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå“è³ª      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  7.5 / 10
ä¾å­˜é–¢ä¿‚ç®¡ç†          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  6.5 / 10
```

---

## 1. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ 7.0/10

### è‰¯ã„ç‚¹
- Workload Identity Federation: GCPé™çš„ã‚­ãƒ¼ã‚’GitHubã«ä¿å­˜ã—ãªã„
- Secret Manager: Todoist/Slackãƒˆãƒ¼ã‚¯ãƒ³ã‚’TerraformçµŒç”±ã§Cloud Run Jobã«æ³¨å…¥
- `.dockerignore`: `.env`ãƒ»`token.pickle`ãƒ»`service_account.json` ã‚’é™¤å¤–æ¸ˆã¿
- Geminiå®‰å…¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: HATE_SPEECH / DANGEROUS_CONTENT ãªã©4ã‚«ãƒ†ã‚´ãƒªè¨­å®šæ¸ˆã¿

### æ”¹å–„ç‚¹

**ğŸ”´ é«˜å„ªå…ˆåº¦**: GitHub Actions SAã®æ¨©é™ãŒéå‰°
```
roles/resourcemanager.projectIamAdmin  # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®IAMã‚’åˆ¶å¾¡å¯èƒ½
roles/iam.serviceAccountAdmin
roles/iam.workloadIdentityPoolAdmin
```
â†’ Terraform Bootstrapç”¨ã®æ‰‹å‹•å®Ÿè¡ŒSA ã¨ã€æ—¥å¸¸CIç”¨SAã‚’åˆ†é›¢ã™ã‚‹

**ğŸŸ¡ ä¸­å„ªå…ˆåº¦**: Google APIã‚¹ã‚³ãƒ¼ãƒ—ãŒéå¤§
- `drive` ã‚¹ã‚³ãƒ¼ãƒ—å…¨æ¨©é™ â†’ ç”¨é€”ã«ã‚ˆã£ã¦ã¯ `drive.file` ã§ååˆ†

**ğŸŸ¢ ä½å„ªå…ˆåº¦**: `.coverage` ãƒ•ã‚¡ã‚¤ãƒ«ãŒgitç®¡ç†ä¸‹
```gitignore
# .gitignore ã«è¿½åŠ 
.coverage
*.coverage
```

---

## 2. å¯è¦³æ¸¬æ€§ãƒ»ç›£è¦– 4.5/10 âš ï¸ æœ€é‡è¦æ”¹å–„é ˜åŸŸ

### è‰¯ã„ç‚¹
- Pythonæ¨™æº–loggingã«ã‚ˆã‚‹INFO/DEBUG/ERRORåˆ†é¡
- Cloud Runç’°å¢ƒã§ã¯stdoutãŒè‡ªå‹•ã§Cloud Loggingã«é€ä¿¡

### æ”¹å–„ç‚¹

**ğŸ”´** æ§‹é€ åŒ–ãƒ­ã‚°(JSON)ã«ãªã£ã¦ã„ãªã„ â†’ Cloud Loggingã§severityãŒè‡ªå‹•èªè­˜ã•ã‚Œãªã„
**ğŸ”´** å¤±æ•—ã‚¢ãƒ©ãƒ¼ãƒˆãŒå­˜åœ¨ã—ãªã„ â†’ Jobå¤±æ•—ã‚’èª°ã‚‚çŸ¥ã‚Œãªã„çŠ¶æ…‹
**ğŸŸ¡** Gemini APIã‚³ã‚¹ãƒˆç›£è¦–ãªã—
**ğŸŸ¡** å‡¦ç†çµæœã®é›†è¨ˆã‚µãƒãƒªãƒ¼ãƒ­ã‚°ãŒãªã„

â†’ è©³ç´°ã¯ã€Œå¯è¦³æ¸¬æ€§ ç›®æ¨™çŠ¶æ…‹ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³å‚ç…§

---

## 3. CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ 7.0/10

### è‰¯ã„ç‚¹
- pathsãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«ã‚ˆã‚‹PRæ™‚ã®ä¸è¦å®Ÿè¡ŒæŠ‘åˆ¶
- `concurrency: cancel-in-progress: false` ã§ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­æ–­é˜²æ­¢
- prod ã¯ Build ã¨ Terraform ã‚’åˆ†é›¢ã— `latest-prod` ã‚¿ã‚°ã§é€£æº
- `workflow_dispatch` ã«ã‚ˆã‚‹ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½

### æ”¹å–„ç‚¹

**ğŸ”´** lint/testã‚¸ãƒ§ãƒ–ãŒ ci.yml / cd-dev.yml / cd-prod-build.yml ã®3ç®‡æ‰€ã«é‡è¤‡ï¼ˆReusable Workflowã§è§£æ¶ˆï¼‰
**ğŸ”´** ã‚«ãƒãƒ¬ãƒƒã‚¸æœ€ä½é–¾å€¤æœªè¨­å®š â†’ `--cov-fail-under=80` ã‚’è¿½åŠ 
**ğŸŸ¡** Trivy ã‚³ãƒ³ãƒ†ãƒŠè„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ãªã—
**ğŸŸ¡** `ci.yml` ã« `permissions` stanzaãŒãªã„ï¼ˆGitHubãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ¨©é™ãŒé©ç”¨ï¼‰
**ğŸŸ¢** Dependabotæœªè¨­å®š

---

## 4. ãƒ†ã‚¹ãƒˆå“è³ª 6.5/10

### è‰¯ã„ç‚¹
- v2/é…ä¸‹ã®100%ã‚«ãƒãƒ¬ãƒƒã‚¸é”æˆï¼ˆunitï¼‰
- unit/integration/e2e/manual ã®4å±¤æ§‹é€ 
- `--strict-markers` ã§æœªå®šç¾©ãƒãƒ¼ã‚«ãƒ¼ä½¿ç”¨ã‚’é˜²æ­¢

### æ”¹å–„ç‚¹

**ğŸ”´** `mypy` ãŒCIã§å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„ï¼ˆdevä¾å­˜ã«ã¯ã‚ã‚‹ï¼‰
**ğŸŸ¡** `_process_single` ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³
**ğŸŸ¡** Integration ãƒ†ã‚¹ãƒˆã®å¯¾è±¡ãŒä¸æ˜ç­

---

## 5. ã‚³ãƒ¼ãƒ‰å“è³ªãƒ»ä¿å®ˆæ€§ 7.0/10

### è‰¯ã„ç‚¹
- Hexagonal Architecture ã®é©ç”¨ãŒä¸€è²«
- `frozen=True` dataclass ã«ã‚ˆã‚‹ä¸å¤‰ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
- Ruff ã« B/SIM/UP ã‚’å«ã‚€å……å®Ÿè¨­å®š

### æ”¹å–„ç‚¹

**ğŸŸ¡** ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«æ®‹ç•™: `main_v2.py`, `deploy_v2.sh`
**ğŸŸ¡** `pyproject.toml` æœªæ›´æ–°: `name = "school-ai-app"`, `description = "Add your description here"`
**ğŸŸ¢** `pandas` ãŒä¸è¦ãªä¾å­˜ã¨ã—ã¦å«ã¾ã‚Œã¦ã„ã‚‹

---

## 6. ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ 7.0/10

### è‰¯ã„ç‚¹
- Terraformãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²
- workload_identity ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã‚ˆã‚‹WIFç®¡ç†
- Secret ManagerçµŒç”±ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ³¨å…¥

### æ”¹å–„ç‚¹

**ğŸ”´** `terraform.tfstate.*.backup` ãŒ .gitignore ã®å¯¾è±¡å¤–ï¼ˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ãï¼‰
```gitignore
# ä¿®æ­£
terraform/**/terraform.tfstate*.backup
```
**ğŸŸ¡** Terraform ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆã®å¯èƒ½æ€§ï¼ˆdevã¯GCSç®¡ç†ã‹è¦ç¢ºèªï¼‰

---

## 7. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° 6.5/10

### è‰¯ã„ç‚¹
- ãƒ•ã‚¡ã‚¤ãƒ«å˜ä½ã§ã®ã‚¨ãƒ©ãƒ¼éš”é›¢
- `logger.exception()` ã«ã‚ˆã‚‹ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ä»˜ããƒ­ã‚°
- Null Object Patternï¼ˆTodoist/Slackæœªè¨­å®šæ™‚ï¼‰

### æ”¹å–„ç‚¹

**ğŸ”´** ä¸€æ™‚çš„ãªAPIã‚¨ãƒ©ãƒ¼ã¸ã®ãƒªãƒˆãƒ©ã‚¤ãŒãªã„ â†’ `tenacity` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å°å…¥ã‚’æ¨å¥¨
**ğŸŸ¡** è¨­å®šèª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã«ç©ºãƒªã‚¹ãƒˆã‚’è¿”ã™ â†’ `sys.exit(1)` ã§éã‚¼ãƒ­çµ‚äº†ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™ã¹ã

---

## 8. é–‹ç™ºè€…ä½“é¨“ 6.0/10

### è‰¯ã„ç‚¹
- `uv` ã«ã‚ˆã‚‹é«˜é€Ÿãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†
- `.env.example` ã«ã‚ˆã‚‹è¨­å®šä¾‹ã®æä¾›

### æ”¹å–„ç‚¹

**ğŸŸ¡** pre-commit ãƒ•ãƒƒã‚¯ãŒæœªè¨­å®š
**ğŸŸ¡** CONTRIBUTING.md ã®æ¬ å¦‚
**ğŸŸ¢** ãƒ­ãƒ¼ã‚«ãƒ«ç”¨ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨CI/CDã®å½¹å‰²ãŒä¸æ˜ç­

---

## 9. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå“è³ª 7.5/10

### è‰¯ã„ç‚¹
- `ARCHITECTURE_V2.md` ãŒ Hexagonal Architecture ã‚’è©³ç´°èª¬æ˜
- `SPECIFICATION.md` ãŒæ©Ÿèƒ½ä»•æ§˜ã‚’ç¶²ç¾…
- `docs/plan/` ã«è¨­è¨ˆæ¤œè¨ã®çµŒç·¯ãŒæ®‹ã£ã¦ã„ã‚‹

### æ”¹å–„ç‚¹

**ğŸŸ¢** `docs/plan/` ã®è§£æ±ºæ¸ˆã¿è¨ˆç”»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ archive/ ã¸ç§»å‹•æ¨å¥¨

---

## 10. ä¾å­˜é–¢ä¿‚ç®¡ç† 6.5/10

### è‰¯ã„ç‚¹
- uv lockfile
- Modern Python 3.13
- Separate dev dependencies

### æ”¹å–„ç‚¹

**ğŸŸ¡** `pandas` ãŒä¸è¦ï¼ˆ`v2/` ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆãªã—ï¼‰
**ğŸŸ¡** `functions-framework`/`flask` ãŒ Cloud Run Jobsæ™‚ä»£ã«ã¯ä¸è¦ï¼ˆCloud Functionsæ™‚ä»£ã®åæ®‹ï¼‰
**ğŸŸ¢** Dependabot/Renovate æœªè¨­å®š

---

## å„ªå…ˆæ”¹å–„ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

| å„ªå…ˆåº¦ | èª²é¡Œ | å·¥æ•°æ„Ÿ |
|--------|------|--------|
| ğŸ”´ é«˜ | æ§‹é€ åŒ–ãƒ­ã‚°(JSON)ã¨Cloud Monitoringå¤±æ•—ã‚¢ãƒ©ãƒ¼ãƒˆã®è¿½åŠ  | ä¸­ |
| ğŸ”´ é«˜ | lint/testã‚¸ãƒ§ãƒ–ã®Reusable WorkflowåŒ– | å° |
| ğŸ”´ é«˜ | ã‚«ãƒãƒ¬ãƒƒã‚¸æœ€ä½é–¾å€¤ã®è¨­å®š (`--cov-fail-under`) | å° |
| ğŸ”´ é«˜ | tfstate.backup ã® .gitignore ä¿®æ­£ | å° |
| ğŸ”´ é«˜ | APIå¤±æ•—æ™‚ã®ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹ (tenacity) | ä¸­ |
| ğŸŸ¡ ä¸­ | mypy ã®CIè¿½åŠ  | å° |
| ğŸŸ¡ ä¸­ | `_process_single` ã®å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ä¿®æ­£ | å° |
| ğŸŸ¡ ä¸­ | Trivy ã‚³ãƒ³ãƒ†ãƒŠè„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ | å° |
| ğŸŸ¡ ä¸­ | pre-commit ãƒ•ãƒƒã‚¯è¨­å®š | å° |
| ğŸŸ¡ ä¸­ | `pandas`ãƒ»`functions-framework` ã®ä¸è¦ä¾å­˜é™¤å» | å° |
| ğŸŸ¡ ä¸­ | GitHub Actions SA æ¨©é™ã®æœ€å°åŒ–ï¼ˆBootstrap SAåˆ†é›¢ï¼‰ | å¤§ |
| ğŸŸ¢ ä½ | ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤ãƒ»æ•´ç† | å° |
| ğŸŸ¢ ä½ | `pyproject.toml` ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–° | å° |

---

## å¯è¦³æ¸¬æ€§ ç›®æ¨™çŠ¶æ…‹ï¼ˆè©³ç´°ï¼‰

### ç¾çŠ¶ã®å•é¡Œ
Cloud Run Jobsã¯ã€Œå®Ÿè¡Œã—ã¦çµ‚ã‚ã‚Šã€ã®ãƒãƒƒãƒå‡¦ç†ã§ã‚ã‚Šã€ç¾çŠ¶ã§ã¯ï¼š
- å¤±æ•—ã—ã¦ã‚‚èª°ã‚‚æ°—ã¥ã‹ãªã„
- ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½•ä»¶å‡¦ç†ã•ã‚ŒãŸã‹é›†è¨ˆã§ããªã„
- Gemini APIã®ã‚³ã‚¹ãƒˆãŒå¯è¦–åŒ–ã•ã‚Œã¦ã„ãªã„
- ã‚¢ãƒ©ãƒ¼ãƒˆãŒãªã„ãŸã‚ã€é‹ç”¨ãŒã€Œç¥ˆã‚Šã€ãƒ™ãƒ¼ã‚¹

### ç›®æ¨™çŠ¶æ…‹: 4ã¤ã®è¦³ç‚¹

#### 1. ãƒ­ã‚°ã®æ§‹é€ åŒ–

**ç¾çŠ¶**:
```
2026-02-23 14:30:05 [INFO] v2.services.orchestrator: Found 3 files to process
```

**ç›®æ¨™**:
```json
{
  "severity": "INFO",
  "message": "Found 3 files to process",
  "logger": "v2.services.orchestrator",
  "timestamp": "2026-02-23T14:30:05Z",
  "labels": {
    "job_name": "school-agent-v2-dev",
    "execution_id": "exec-abc123"
  }
}
```

å®Ÿè£…æ–¹æ³•: `logging.Formatter` ã‚’JSONãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å·®ã—æ›¿ãˆã‚‹ã‹ã€`google-cloud-logging` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã€‚

#### 2. å‡¦ç†çµæœã®é›†è¨ˆãƒ­ã‚°

å®Ÿè¡Œçµ‚äº†æ™‚ã«ä»¥ä¸‹ã®ã‚µãƒãƒªãƒ¼ãƒ­ã‚°ã‚’å‡ºåŠ›ï¼š
```json
{
  "severity": "INFO",
  "message": "Execution summary",
  "total_files": 3,
  "events_created": 2,
  "tasks_created": 1,
  "errors": 0,
  "gemini_calls": 3,
  "duration_seconds": 45.2
}
```

ã“ã‚Œã«ã‚ˆã‚Š Cloud Logging ã®ãƒ­ã‚°ãƒ™ãƒ¼ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å®šç¾©ã§ãã‚‹ã€‚

#### 3. Cloud Monitoring ã‚¢ãƒ©ãƒ¼ãƒˆ

è¨­å®šã™ã¹ãã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆå„ªå…ˆé †ï¼‰:

| ã‚¢ãƒ©ãƒ¼ãƒˆ | æ¡ä»¶ | é€šçŸ¥å…ˆ |
|---------|------|--------|
| Jobå®Ÿè¡Œå¤±æ•— | Cloud Run Job ã® exit code != 0 | Slack #alerts |
| ã‚¨ãƒ©ãƒ¼ä»¶æ•°æ€¥å¢— | `errors > 0` ã®ãƒ­ã‚°ãŒé€£ç¶š2å› | Slack #alerts |
| å®Ÿè¡Œæ™‚é–“è¶…é | duration > 5åˆ† | Slack #alerts |
| Geminiã‚¨ãƒ©ãƒ¼ | Gemini API ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°æ¤œå‡º | Slack #alerts |

Cloud Run Jobs ã¯ `Cloud Monitoring` ã® `cloud_run_job` ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã§ç›£è¦–å¯èƒ½ã€‚

Terraformã§å®šç¾©:
```hcl
resource "google_monitoring_alert_policy" "job_failure" {
  display_name = "Cloud Run Job Failure - ${var.job_name}"
  conditions {
    display_name = "Job execution failed"
    condition_threshold {
      filter = "resource.type=\"cloud_run_job\" AND metric.type=\"run.googleapis.com/job/completed_execution_count\" AND metric.labels.result=\"failed\""
      comparison = "COMPARISON_GT"
      threshold_value = 0
      duration = "0s"
    }
  }
  notification_channels = [google_monitoring_notification_channel.slack.id]
}
```

#### 4. Gemini APIã‚³ã‚¹ãƒˆç›£è¦–

- Cloud Billing ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®äºˆç®—ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è¨­å®šï¼ˆæœˆ$Xè¶…ãˆã§ã‚¢ãƒ©ãƒ¼ãƒˆï¼‰
- ãƒ­ã‚°ã«tokenä½¿ç”¨é‡ã‚’è¨˜éŒ²ï¼ˆVertex AI APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã‚‹ï¼‰:
```python
response = model.generate_content(...)
logger.info(
    "Gemini usage: input_tokens=%d, output_tokens=%d",
    response.usage_metadata.prompt_token_count,
    response.usage_metadata.candidates_token_count,
)
```

### å®Ÿè£…å„ªå…ˆé †ä½

1. **ã¾ãšæ§‹é€ åŒ–ãƒ­ã‚°** â†’ Cloud Loggingã§æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŒå®¹æ˜“ã«ãªã‚‹
2. **æ¬¡ã«é›†è¨ˆã‚µãƒãƒªãƒ¼ãƒ­ã‚°** â†’ ãƒ­ã‚°ãƒ™ãƒ¼ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åŸºç›¤ãŒã§ãã‚‹
3. **æœ€å¾Œã«ã‚¢ãƒ©ãƒ¼ãƒˆ** â†’ Cloud Monitoringã®ã‚¢ãƒ©ãƒ¼ãƒˆãƒãƒªã‚·ãƒ¼ã‚’è¨­å®š

ã“ã®é †åºã§é€²ã‚ã‚‹ã¨ã€ã‚¤ãƒ³ãƒ•ãƒ©å¤‰æ›´ãªã—ã«ãƒ­ã‚°æ”¹å–„ã ã‘ã§å¤§å¹…ã«å¯è¦³æ¸¬æ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚
